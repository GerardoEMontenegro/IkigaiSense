{% load widget_tweaks %}
{% load static %}
{% load django_browser_reload %}
{% django_browser_reload_script %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="{% static 'assets/favicon2.png' %}" type="image/x-icon" />
  <script type="module" src="{% static 'js/tailwind.js' %}"></script>
</head>
<body class="bg-[#F6F2E6] text-gray-900">

{% block title %}Registro{% endblock title %}

{% block content %}
<div class="flex h-screen bg-[#F6F2E6] text-gray-900">

  <div class="w-2/3 hidden md:flex items-center justify-center">
    <img src="{% static 'assets/login-side-image.jpeg' %}" alt="bienestar" class="w-full h-full object-cover" />
  </div>

  <div class="w-full md:w-1/3 flex items-center justify-center bg-[#F6F2E6] px-6 py-12">

    <div class="w-full max-w-sm space-y-6">

      <div class="text-center">
        <img src="{% static 'assets/logo2.png' %}" alt="logo" class="w-36 h-auto mx-auto mb-4">
        <h2 class="text-xl font-bold tracking-tight text-[#3F4F36]">CREAR UNA CUENTA</h2>
      </div>

      {% if form.errors %}
        <div class="mb-4 text-sm text-red-600">
          {% for field in form %}
            {% for error in field.errors %}
              <p>{{ error }}</p>
            {% endfor %}
          {% endfor %}
        </div>
      {% endif %}

      <form method="post" class="space-y-5" novalidate>
        {% csrf_token %}

        <div>
          <label for="{{ form.username.id_for_label }}" class="block text-sm font-medium text-gray-700">Usuario</label>
          {{ form.username|add_class:"block w-full rounded-md bg-white px-3 py-2 text-gray-900 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500" }}
        </div>
        <div>
          <label for="{{ form.alias.id_for_label }}" class="block text-sm font-medium text-gray-700">Alias (opcional)</label>
          {{ form.alias|add_class:"block w-full rounded-md bg-white px-3 py-2 text-gray-900 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500" }}
        </div>

        <div>
          <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700">Correo electrónico</label>
          {{ form.email|add_class:"block w-full rounded-md bg-white px-3 py-2 text-gray-900 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500" }}
        </div>

        <div>
          <label for="{{ form.password1.id_for_label }}" class="block text-sm font-medium text-gray-700">Contraseña</label>
          {{ form.password1|add_class:"block w-full rounded-md bg-white px-3 py-2 text-gray-900 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500"|attr:"id:password1" }}

          <p class="mt-1 text-xs text-gray-500">
            La contraseña debe tener al menos 8 caracteres, incluir letras mayúsculas, minúsculas y números.
          </p>

          {% if form.password1.errors %}
            <p class="mt-1 text-sm text-red-600">
              {{ form.password1.errors.0 }}
            </p>
          {% endif %}
        </div>

        <div>
          <label for="{{ form.password2.id_for_label }}" class="block text-sm font-medium text-gray-700">Confirmar contraseña</label>
          {{ form.password2|add_class:"block w-full rounded-md bg-white px-3 py-2 text-gray-900 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500"|attr:"id:password2" }}

          <p id="password-match-message" class="text-sm mt-1"></p>

          {% if form.password2.errors %}
            <p class="mt-1 text-sm text-red-600">
              {{ form.password2.errors.0 }}
            </p>
          {% endif %}
        </div>

        <button type="submit" class="w-full bg-[#3F4F36] hover:bg-[#2f3c28] text-white font-semibold py-2 rounded-md transition duration-200">
          Registrarse
        </button>
      </form>

      <div class="text-center">
        <a href="{% url 'user:auth_login' %}" class="text-sm text-blue-500 hover:underline">
          ¿Ya tenés cuenta? Ingresar
        </a>
      </div>

    </div>

  </div>
</div>

<script>
  const pass1 = document.getElementById('password1');
  const pass2 = document.getElementById('password2');
  const message = document.getElementById('password-match-message');

  function checkPasswords() {
    if (!pass1.value && !pass2.value) {
      message.textContent = '';
      message.className = 'text-sm mt-1';
      return;
    }
    if (pass1.value === pass2.value) {
      message.textContent = 'Las contraseñas coinciden ✅';
      message.className = 'text-sm mt-1 text-green-600';
    } else {
      message.textContent = 'Las contraseñas no coinciden ❌';
      message.className = 'text-sm mt-1 text-red-600';
    }
  }

  pass1.addEventListener('input', checkPasswords);
  pass2.addEventListener('input', checkPasswords);
</script>
{% endblock content %}
